{% extends "base.html" %}
{% block content %}

<h2>Admin Dashboard</h2>
<p class="mb-4">View and approve customer agent requests.</p>

{% if agents %}
  <div class="table-responsive">
    <table class="table table-dark table-striped align-middle">
      <thead>
        <tr>
          <th>User</th>
          <th>Agent</th>
          <th>Category</th>
          <th>Plan</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for agent in agents %}
        <tr>
          <td>{{ agent[1] }}</td>
          <td>{{ agent[2] }}</td>
          <td>{{ agent[3] }}</td>
          <td>{{ agent[4] or '-' }}</td>
          <td>
            {% if agent[5] == 'pending' %}
              <span class="badge bg-warning text-dark">Pending</span>
            {% elif agent[5] == 'active' %}
              <span class="badge bg-success">Active</span>
            {% else %}
              <span class="badge bg-secondary">Unknown</span>
            {% endif %}
          </td>
          <td>
            {% if agent[5] == 'pending' %}
              <form method="POST" action="{{ url_for('activate_agent', agent_id=agent[0]) }}">
                <button class="btn btn-sm btn-success">Approve</button>
              </form>
            {% else %}
              <span class="text-muted">-</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <p>No agents found.</p>
{% endif %}

<a class="btn btn-outline-light mt-4" href="{{ url_for('logout') }}">Logout</a>

{% endblock %}
